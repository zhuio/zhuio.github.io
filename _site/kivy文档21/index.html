<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>kivy文档21 – 朱智博在Github上的Blog</title> <meta name="description" content="朱智博，朱智博的博客，zhuio,zhuio.github.io,"> <meta name="keywords" content="kivy"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/logo.png"> <meta name="twitter:title" content="kivy文档21"> <meta name="twitter:description" content="Kivy中文编程指南：更好用 Android 打包虚拟机"> <!-- Open Graph --> <meta property="og:locale" content="zh_CN"> <meta property="og:type" content="article"> <meta property="og:title" content="kivy文档21"> <meta property="og:description" content="Kivy中文编程指南：更好用 Android 打包虚拟机"> <meta property="og:url" content="http://localhost:4000/kivy%E6%96%87%E6%A1%A321/"> <meta property="og:site_name" content="朱智博在Github上的Blog"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/kivy%E6%96%87%E6%A1%A321/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="朱智博在Github上的Blog Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png"> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="朱智博在Github上的Blog photo" class="author-photo"> <h4>朱智博在Github上的Blog</h4> <p>朱智博，朱智博的博客，zhuio,zhuio.github.io,</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:185560083@qq.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com/zhuio" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://www.weibo.com/EDM_LOVER" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-weibo"></i> Weibo</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>kivy文档21</h1> <h4>07 Aug 2017</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~1 minute </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="kivy中文编程指南更好用-android-打包虚拟机">Kivy中文编程指南：更好用 Android 打包虚拟机</h1> <p><a href="http://brizanmedia.com/wp/2016/07/10/the-fool-proof-guide/">英文原文地址</a></p> <h2 id="译者的废话">译者的废话</h2> <p>开头先给干货，本文提到的<a href="https://pan.baidu.com/s/1mhIUz3q">虚拟机镜像的下载地址</a>。</p> <p>从去年开始，我开始了 <a href="https://github.com/cycleuser/Kivy-CN">Kivy 编程指南中文翻译项目</a>，把 Kivy Programming Guide 里面的全部内容翻译了一遍。大家可以去我的<a href="https://zhuanlan.zhihu.com/python-kivy">知乎专栏</a>或者我的 <a href="https://github.com/cycleuser">GitHub</a> 查看详细内容。</p> <p>Kivy 的多平台支持以及使用 Python 这一新手友好的语言的两大特性都很棒，然而世事难求全，APK 生成和搭建有时候挺繁琐的，尤其对于一些不太熟悉 Linux 的纯新人。所以官方提供了很多文档，我也进行了翻译，包括<a href="https://zhuanlan.zhihu.com/p/25576296">KV Android 详细指南</a>,<a href="https://zhuanlan.zhihu.com/p/25571974">打包为 Android 系统可执行文件</a>，以及一个<a href="https://zhuanlan.zhihu.com/p/25583908"> Kivy 开发团队提供的 Android 打包用的虚拟机镜像</a>。国内的大拿 <a href="https://github.com/nkiiiiid/">nkiiiiid</a> 也提供了一个他的定制版本的<a href="https://github.com/nkiiiiid/kivy-apk-">虚拟机镜像</a>。更推荐用<a href="https://github.com/nkiiiiid/">nkiiiiid</a> 提供的这个版本，16.04 用着更舒服。群里面大家也普遍喜欢用这个版本。</p> <p>然后进有一位@郝好 的朋友提供了重要信息，说<a href="http://brizanmedia.com">brizanmedia.com</a> 提供的这个 lubuntu 14.04.3 的 32bit 虚拟机镜像用着很不错。</p> <p>然后作为常年搬运工的我，就顺手下载下来发到百度云，并且翻译一下原文咯。 原文有很多叹号，我个人不喜欢用叹号，不过在本文我还是忠于原文的风格，在措辞和符号上与原文保持一致。</p> <p>废话完毕，以下是 <a href="http://brizanmedia.com">brizanmedia.com</a> 的原文翻译。</p> <p>##使用 Python + Kivy 创建 Android 应用的防呆指南~</p> <p>Kivy 是一个支持多点触摸的 Python 框架，可以运行于 Windows，OS X，Linux ，iOS 以及 Android 系统。不过在 Android 上运行 Kivy，还挺麻烦的，因为需要先把代码打包成一个应用。下面的指南是让你从 Python 代码打包到 Android 应用的方法，一定能够成功的哦~</p> <p>Kivy 官方的指南上面，有一个<a href="https://kivy.org/docs/guide/packaging-android.html">如何给 Android 系统打包的指南文档</a>，（译者也翻译了一份<a href="https://zhuanlan.zhihu.com/p/25571974">中文版本的 Android 打包指南</a>）。不过这些方法都不能用在 Windows 或者 OS X 上面，另外官方的指南很简略，略过了很多步骤。</p> <p>本文提供的这个方案很简单，所有事情都在虚拟机里面解决，包括打包的步骤。目前来说，Kivy 团队确实做了开创性的工作，不过还有以下的问题：</p> <ol> <li>他们提供的虚拟机使用的是 Ubuntu 操作系统，这样性能开销比较大，用起来运行速度很慢；</li> <li>从代码打包生成应用的必备步骤并没有明确给出清晰透彻的指南。</li> </ol> <p>于是本文作者自己创建了一个虚拟机镜像，尽可能提高运行速度，争取做到和本机原生操作接近的体验。</p> <h3 id="初始步骤">初始步骤</h3> <p>第一步就是要下载本文作者提供的 <a href="http://brizanmedia.com/wp/wp-content/LXLE14.04.3%5C(32bit%5C).vdi.zip">Linux 虚拟机硬盘镜像</a>。这个镜像文件挺大的，4G 左右，不过值得你为下载它而付出的等待。（译者注：毕竟能用就不错，而且平心而论这个 Lubuntu 14.04.4 32bit 的虚拟机镜像确实速度比较快，性能开销压力不大。）然后你还需要下载<a href="http://www.oracle.com/technetwork/server-storage/virtualbox/downloads/index.html"> Oracle VM Virtualbox</a> ，并且安装到你的系统中。关于怎么弄虚拟机这些就不给讲了，都很简单而且网上资料很多。</p> <p><strong>下面这个特别重要</strong>：安装完毕之后，运行 VirtualBox，然后创建一个新的虚拟机，使用刚刚下载的这个 vdi 文件作为硬盘。你唯一需要设置的是把操作系统设置为 Linux，版本<strong>必须</strong>设置为 Ubuntu 32bit。如果你需要进一步的指南，可以看<a href="https://www.youtube.com/watch?v=1P_l7iVKfgs">这个视频</a>。这个视频展示了如何安装 VirtualBox 以及用一个已有的 vdi 文件创建新的虚拟机，你就可以按照这个指南来做。（译者注：国内也有很多类似的视频，推荐自己搜索一下，这里就不搬运原版视频了。）</p> <h3 id="开始构建吧">开始构建吧！</h3> <p>打开虚拟机，启动到登录界面，<strong>用户名和密码都是</strong><code class="highlighter-rouge">osboxes.org</code>。</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox1.jpg" alt="vbox1"></p> <p>这里顺路要感谢一下 <a href="http://www.osboxes.org/">osboxes.org</a>。（译者注：这个网站分享各种已经装好的虚拟机镜像，VirtualBox 和 Vmware 的都有，非常赞，可以下载来当做各种测试环境。）</p> <p>登陆之后就能看到桌面了： <img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox2-1024x640.jpg" alt="vbox2"></p> <p>本文作者把所有构建 APK 的相关指南都放到了桌面壁纸上面，不过这里还是会用很多屏幕截图来给讲述一遍。</p> <p>1. 点击图示的按钮启动终端，（名字通常是 ROXTerm 之类的）。</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox3-1024x640.jpg" alt="vbox3"></p> <p>2. 在终端中输入下面的命令，（或者也可以用向上的方向键来查看之前的输入历史，里面能找到，下同）：</p>
<pre><code class="language-Bash">cd ~/Desktop/kivycode
</code></pre>
<p>输入之后，按回车键。这样就让你进入到 <code class="highlighter-rouge">kivycode</code> 这个目录了。你必须进入这个目录，这样接下来的第 4 步才能成功。</p> <p>3. 在终端中输入下面的命令：</p>
<pre><code class="language-Bash">cp ~/Desktop/buildozer.spec ~Desktop/kivycode
</code></pre>
<p>输入之后还是按回车键。这回把 buildozer.spec 文件复制到这个 <code class="highlighter-rouge">kivycode</code> 目录以供使用。当然你也可以在图形界面下来复制粘贴过来。</p> <p>4. 在终端中输入下面的命令：</p>
<pre><code class="language-Bash">buildozer android debug
</code></pre>
<p>输入之后按回车咯。这一步是真正在创建 APK 文件。如果所有步骤都没问题，你的 APK 文件就会被生成放到桌面上。接下来就把 APK 文件安装到你的 Android 设备上面去试试吧！</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/linux4Python4Android-1024x640.jpg" alt="linux4Python4Android"></p> <p>以上这样，你就创建了第一个 Android 安装包！</p> <h3 id="接下来开始用你的代码来创建">接下来开始用你的代码来创建！</h3> <p>你刚刚构建过一个 APK 了，不过这个 APK 并没有怎么充分利用这个虚拟机。而且代码还不是你自己的。所以咱们来试试你自己的代码。</p> <p>首先咱们要让虚拟机能和外界交换文件。本文作者的选择是使用了一个外置硬盘。把外置硬盘插到机器（的宿主系统）中，然后把要变异的内容复制进去。接下来把 USB 设备从宿主机器移除，添加给虚拟机，这个操作反过来也可以，只需要在 VirtualBox 菜单栏中的 <code class="highlighter-rouge">Devices -&gt; USB Devices</code> 中对选中的设备进行点击即可。</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox4-1024x640.jpg" alt="vbox4"></p> <p>磁盘就会出现在虚拟机系统中了：</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox5-1024x640.jpg" alt="vbox5"></p> <p>如果你没有外置磁盘，可以用浏览器来把文件传递到谷歌硬盘之类的云盘，然后虚拟机里面再下载。</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox8-1024x640.jpg" alt="vbox8"></p> <p>VirtualBox 本来还是有一个共享文件夹功能的，可以让宿主机和虚拟机之间共用一个文件夹，不过本文作者没弄明白怎么搞定这个功能。如果有人能搞定这个请告诉<strong>本文作者</strong>怎么实现，非常感谢。（译者注：^_^，不用留言给中文版这里，是英文原版作者不会实现共享文件夹。）</p> <p>现在文件能够拷入拷出了，就可以编译你自己的代码了。把你要编译的代码放到桌面上的 <code class="highlighter-rouge">kivycode</code> 这个目录。只要把这个文件夹里面的所有文件都用你的代码文件替换了，就可以打包你自己的应用了。视频之类的一些东西还需要额外打包设定，你还得使用 Kivy 框架，不过目前来看，Python 2.7 的代码都能打包成功没问题。</p> <p><img src="http://brizanmedia.com/wp/wp-content/uploads/2016/07/vbox6-1024x640.jpg" alt="vbox6"></p> <p>编译你自己代码之前的最后一件事了，就是把 <code class="highlighter-rouge">buildozer.spec</code> 这个文件从桌面复制到 <code class="highlighter-rouge">kivycode</code> 文件夹，然后对副本进行必要的编辑。各种选项相关的信息可以参考 <a href="https://buildozer.readthedocs.io/en/latest/specifications.html">Buildozer 的官方在线文档</a>。</p> <p>比如你可能要修改加载图像 loading.png 以及图标文件 icon.png 等等，反正就那些了。接下来你就可以把你的 Python 代码构建成 Android 的 APK，然后从虚拟机的桌面找到这个 APK ，安装到你的 Android 设备上面来试试了。</p> <p>好好玩吧！</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#kivy" title="Pages tagged kivy" class="tag"><span class="term">kivy</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/kivy%E6%96%87%E6%A1%A321/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/kivy%E6%96%87%E6%A1%A321/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/kivy%E6%96%87%E6%A1%A321/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <h101> <!-- 多说评论框 start --> <div class="ds-thread" data-thread-key="" data-title="kivy文档21" data-url="http://localhost:4000"></div> <!-- 多说评论框 end --> <!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"zhuio"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --> </h101> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'zhuio-github-io'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
